================================================================================
üéØ DOCUMENTACI√ìN: ENDPOINT LISTAR CR√âDITOS PENDIENTES
================================================================================

üìã √çNDICE:
1. Resumen del Endpoint
2. C√≥digo Backend (Java Spring Boot)
   2.1. DTO: CreditoPendienteDTO.java
   2.2. Repository: CreditoRepository.java (query method)
   2.3. Service: CreditoService.java (m√©todo listarCreditosPendientes)
   2.4. Controller: CreditoController.java (endpoint GET)
3. C√≥digo Frontend (JavaScript/React)
   3.1. Servicio API
   3.2. Uso en componente
4. Ejemplos de Uso
5. Comparaci√≥n: Antes vs Ahora

================================================================================
1. RESUMEN DEL ENDPOINT
================================================================================

M√âTODO:     GET
URL:        /api/creditos/cliente/{clienteId}/pendientes
PROP√ìSITO:  Obtener SOLO los cr√©ditos con saldo pendiente > 0 para la 
            p√°gina de abonos

VENTAJAS:
‚úÖ Solo trae cr√©ditos con saldo > 0 (filtro en backend)
‚úÖ Incluye tieneRetencionFuente (CR√çTICO para c√°lculos)
‚úÖ Incluye subtotal (necesario para calcular retenci√≥n)
‚úÖ Incluye toda la info de la orden sin consultas adicionales
‚úÖ Ordenado por fecha (m√°s recientes primero)
‚úÖ Reduce tr√°fico de red (solo lo necesario)

FILTROS AUTOM√ÅTICOS EN BACKEND:
- estado = ABIERTO
- saldoPendiente > 0
- clienteId = {par√°metro}

REQUEST:
GET /api/creditos/cliente/7/pendientes

RESPONSE 200 OK:
[
  {
    // === DATOS DEL CR√âDITO ===
    "creditoId": 31,
    "totalCredito": 500000.00,
    "totalAbonado": 200000.00,
    "saldoPendiente": 300000.00,
    "estado": "ABIERTO",
    
    // === DATOS DE LA ORDEN ===
    "ordenId": 124,
    "ordenNumero": 1001,
    "ordenFecha": "2025-12-01",
    "ordenObra": "Casa Matriz",
    
    // === MONTOS DE LA ORDEN ===
    "total": 500000.00,           // Total facturado (con IVA)
    "subtotal": 420168.07,        // Subtotal SIN IVA (IMPORTANTE para retefuente)
    "iva": 79831.93,              // IVA calculado
    "descuentos": 0.00,
    
    // === RETENCI√ìN DE FUENTE ===
    "tieneRetencionFuente": true,  // CR√çTICO para c√°lculos
    "retencionFuente": 45693.28,
    
    // === DATOS ADICIONALES ===
    "fechaUltimoAbono": "2025-12-15",
    "cantidadAbonos": 3,
    
    // === RELACIONES ===
    "sede": {
      "id": 1,
      "nombre": "Insula"
    },
    "cliente": {
      "id": 7,
      "nombre": "Juan P√©rez",
      "nit": "123456789"
    }
  }
]

ERRORES POSIBLES:
- 400 Bad Request: Validaciones fallidas
- 500 Internal Server Error: Error inesperado

================================================================================
2. C√ìDIGO BACKEND (JAVA SPRING BOOT)
================================================================================

--------------------------------------------------------------------------------
2.1. DTO: CreditoPendienteDTO.java
--------------------------------------------------------------------------------
UBICACI√ìN: src/main/java/com/casaglass/casaglass_backend/dto/CreditoPendienteDTO.java

COPIAR Y PEGAR:

package com.casaglass.casaglass_backend.dto;

import com.casaglass.casaglass_backend.model.Credito;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

import java.time.LocalDate;

/**
 * üí∞ DTO PARA LISTAR CR√âDITOS PENDIENTES EN LA P√ÅGINA DE ABONOS
 * 
 * Contiene toda la informaci√≥n necesaria para:
 * - Mostrar cr√©ditos con saldo pendiente
 * - Calcular retenci√≥n de fuente
 * - Registrar abonos
 * 
 * Endpoint: GET /api/creditos/cliente/{clienteId}/pendientes
 */
@Data
@NoArgsConstructor
@AllArgsConstructor
public class CreditoPendienteDTO {
    
    // ========== DATOS DEL CR√âDITO ==========
    
    /** ID del cr√©dito */
    private Long creditoId;
    
    /** Monto total del cr√©dito original */
    private Double totalCredito;
    
    /** Monto total abonado hasta el momento */
    private Double totalAbonado;
    
    /** Saldo pendiente (totalCredito - totalAbonado - retencionFuente si aplica) */
    private Double saldoPendiente;
    
    /** Estado del cr√©dito: ABIERTO, CERRADO, VENCIDO, ANULADO */
    private String estado;
    
    // ========== DATOS DE LA ORDEN ==========
    
    /** ID de la orden que origin√≥ el cr√©dito */
    private Long ordenId;
    
    /** N√∫mero de orden √∫nico */
    private Long ordenNumero;
    
    /** Fecha de la orden */
    private LocalDate ordenFecha;
    
    /** Obra/proyecto de la orden */
    private String ordenObra;
    
    // ========== MONTOS DE LA ORDEN ==========
    
    /** Total facturado (subtotal + IVA - descuentos) */
    private Double total;
    
    /** Subtotal sin IVA - IMPORTANTE para calcular retenci√≥n de fuente */
    private Double subtotal;
    
    /** IVA calculado */
    private Double iva;
    
    /** Descuentos aplicados */
    private Double descuentos;
    
    // ========== RETENCI√ìN DE FUENTE ==========
    
    /** Indica si la orden tiene retenci√≥n de fuente - CR√çTICO */
    private Boolean tieneRetencionFuente;
    
    /** Valor de la retenci√≥n en la fuente */
    private Double retencionFuente;
    
    // ========== DATOS ADICIONALES ==========
    
    /** Fecha del √∫ltimo abono realizado (opcional) */
    private LocalDate fechaUltimoAbono;
    
    /** Cantidad total de abonos realizados */
    private Integer cantidadAbonos;
    
    // ========== RELACIONES ==========
    
    /** Informaci√≥n de la sede */
    private SedeSimpleDTO sede;
    
    /** Informaci√≥n del cliente (opcional, normalmente ya se tiene) */
    private ClienteSimpleDTO cliente;
    
    // ========== DTOs INTERNOS ==========
    
    @Data
    @NoArgsConstructor
    @AllArgsConstructor
    public static class SedeSimpleDTO {
        private Long id;
        private String nombre;
    }
    
    @Data
    @NoArgsConstructor
    @AllArgsConstructor
    public static class ClienteSimpleDTO {
        private Long id;
        private String nombre;
        private String nit;
    }
    
    // ========== CONSTRUCTOR DESDE ENTIDAD ==========
    
    /**
     * Constructor que mapea desde la entidad Credito
     * Extrae todos los datos necesarios de la orden asociada
     */
    public CreditoPendienteDTO(Credito credito) {
        // Datos del cr√©dito
        this.creditoId = credito.getId();
        this.totalCredito = credito.getTotalCredito();
        this.totalAbonado = credito.getTotalAbonado();
        this.saldoPendiente = credito.getSaldoPendiente();
        this.estado = credito.getEstado().name();
        
        // Datos de la orden
        if (credito.getOrden() != null) {
            this.ordenId = credito.getOrden().getId();
            this.ordenNumero = credito.getOrden().getNumero();
            this.ordenFecha = credito.getOrden().getFecha();
            this.ordenObra = credito.getOrden().getObra();
            
            // Montos de la orden
            this.total = credito.getOrden().getTotal();
            this.subtotal = credito.getOrden().getSubtotal();
            this.iva = credito.getOrden().getIva();
            this.descuentos = credito.getOrden().getDescuentos();
            
            // Retenci√≥n de fuente
            this.tieneRetencionFuente = credito.getOrden().isTieneRetencionFuente();
            this.retencionFuente = credito.getOrden().getRetencionFuente();
            
            // Sede
            if (credito.getOrden().getSede() != null) {
                this.sede = new SedeSimpleDTO(
                    credito.getOrden().getSede().getId(),
                    credito.getOrden().getSede().getNombre()
                );
            }
        }
        
        // Cliente
        if (credito.getCliente() != null) {
            this.cliente = new ClienteSimpleDTO(
                credito.getCliente().getId(),
                credito.getCliente().getNombre(),
                credito.getCliente().getNit()
            );
        }
        
        // Datos adicionales de abonos
        if (credito.getAbonos() != null && !credito.getAbonos().isEmpty()) {
            this.cantidadAbonos = credito.getAbonos().size();
            
            // Encontrar fecha del √∫ltimo abono
            this.fechaUltimoAbono = credito.getAbonos().stream()
                .map(abono -> abono.getFecha())
                .max(LocalDate::compareTo)
                .orElse(null);
        } else {
            this.cantidadAbonos = 0;
            this.fechaUltimoAbono = null;
        }
    }
}

--------------------------------------------------------------------------------
2.2. Repository: CreditoRepository.java (agregar este m√©todo)
--------------------------------------------------------------------------------
UBICACI√ìN: src/main/java/com/casaglass/casaglass_backend/repository/CreditoRepository.java

COPIAR Y PEGAR DESPU√âS DE findByClienteIdAndEstado:

    // üí∞ M√âTODO ESPECIALIZADO PARA P√ÅGINA DE ABONOS - Cr√©ditos pendientes con saldo > 0
    List<Credito> findByClienteIdAndEstadoAndSaldoPendienteGreaterThan(Long clienteId, Credito.EstadoCredito estado, Double saldoPendiente);

--------------------------------------------------------------------------------
2.3. Service: CreditoService.java (agregar este m√©todo)
--------------------------------------------------------------------------------
UBICACI√ìN: src/main/java/com/casaglass/casaglass_backend/service/CreditoService.java

COPIAR Y PEGAR AL FINAL DE LA CLASE (antes del cierre }):

    /**
     * üí∞ LISTAR CR√âDITOS PENDIENTES DE UN CLIENTE
     * 
     * Endpoint especializado para la p√°gina de abonos.
     * Retorna SOLO los cr√©ditos con saldo pendiente > 0 y estado ABIERTO.
     * 
     * Caracter√≠sticas:
     * - Filtra autom√°ticamente: estado = ABIERTO AND saldoPendiente > 0
     * - Incluye todos los datos necesarios para registrar abonos
     * - Incluye informaci√≥n de retenci√≥n de fuente
     * - Incluye subtotal (necesario para calcular retenci√≥n)
     * - Ordenado por fecha de orden (m√°s recientes primero)
     * 
     * @param clienteId ID del cliente
     * @return Lista de CreditoPendienteDTO con toda la informaci√≥n necesaria
     */
    @Transactional(readOnly = true)
    public List<com.casaglass.casaglass_backend.dto.CreditoPendienteDTO> listarCreditosPendientes(Long clienteId) {
        System.out.println("üí∞ DEBUG: Listando cr√©ditos pendientes para cliente ID: " + clienteId);
        
        // Buscar cr√©ditos del cliente con estado ABIERTO y saldo > 0
        List<Credito> creditos = creditoRepo.findByClienteIdAndEstadoAndSaldoPendienteGreaterThan(
            clienteId, 
            Credito.EstadoCredito.ABIERTO, 
            0.0
        );
        
        System.out.println("üí∞ DEBUG: Encontrados " + creditos.size() + " cr√©ditos pendientes");
        
        // Convertir a DTO
        List<com.casaglass.casaglass_backend.dto.CreditoPendienteDTO> resultado = creditos.stream()
            .map(com.casaglass.casaglass_backend.dto.CreditoPendienteDTO::new)
            .sorted((a, b) -> {
                // Ordenar por fecha de orden (m√°s recientes primero)
                if (a.getOrdenFecha() == null && b.getOrdenFecha() == null) return 0;
                if (a.getOrdenFecha() == null) return 1;
                if (b.getOrdenFecha() == null) return -1;
                return b.getOrdenFecha().compareTo(a.getOrdenFecha());
            })
            .collect(java.util.stream.Collectors.toList());
        
        System.out.println("‚úÖ DEBUG: Retornando " + resultado.size() + " cr√©ditos pendientes");
        
        return resultado;
    }

--------------------------------------------------------------------------------
2.4. Controller: CreditoController.java (agregar este endpoint)
--------------------------------------------------------------------------------
UBICACI√ìN: src/main/java/com/casaglass/casaglass_backend/controller/CreditoController.java

COPIAR Y PEGAR AL FINAL DE LA CLASE (antes del cierre }):

    /**
     * üí∞ LISTAR CR√âDITOS PENDIENTES DE UN CLIENTE
     * GET /api/creditos/cliente/{clienteId}/pendientes
     * 
     * Endpoint especializado para la p√°gina de abonos.
     * Retorna SOLO los cr√©ditos con saldo pendiente > 0 y estado ABIERTO.
     * 
     * Incluye:
     * - Datos del cr√©dito (id, totalCredito, totalAbonado, saldoPendiente, estado)
     * - Datos de la orden (id, numero, fecha, obra)
     * - Montos (total, subtotal, iva, descuentos)
     * - Retenci√≥n de fuente (tieneRetencionFuente, retencionFuente)
     * - Sede y cliente
     * - Informaci√≥n de abonos (fechaUltimoAbono, cantidadAbonos)
     * 
     * Response 200 OK:
     * [
     *   {
     *     "creditoId": 31,
     *     "totalCredito": 500000.00,
     *     "saldoPendiente": 300000.00,
     *     "ordenNumero": 1001,
     *     "subtotal": 420168.07,
     *     "tieneRetencionFuente": true,
     *     "retencionFuente": 45693.28,
     *     ...
     *   }
     * ]
     */
    @GetMapping("/cliente/{clienteId}/pendientes")
    public ResponseEntity<?> listarCreditosPendientes(@PathVariable Long clienteId) {
        try {
            System.out.println("üí∞ DEBUG: Endpoint /creditos/cliente/" + clienteId + "/pendientes");
            
            List<com.casaglass.casaglass_backend.dto.CreditoPendienteDTO> creditos = 
                service.listarCreditosPendientes(clienteId);
            
            return ResponseEntity.ok(creditos);
        } catch (IllegalArgumentException e) {
            System.err.println("‚ùå ERROR VALIDACION: " + e.getMessage());
            return ResponseEntity.badRequest().body(Map.of(
                "error", e.getMessage(),
                "tipo", "VALIDACION"
            ));
        } catch (Exception e) {
            System.err.println("‚ùå ERROR SERVIDOR: " + e.getMessage());
            e.printStackTrace();
            return ResponseEntity.internalServerError().body(Map.of(
                "error", "Error interno del servidor: " + e.getMessage(),
                "tipo", "SERVIDOR"
            ));
        }
    }

================================================================================
3. C√ìDIGO FRONTEND (JAVASCRIPT/REACT)
================================================================================

--------------------------------------------------------------------------------
3.1. Servicio API
--------------------------------------------------------------------------------
UBICACI√ìN: src/services/CreditosService.js (o similar)

COPIAR Y PEGAR:

/**
 * üí∞ Listar cr√©ditos pendientes de un cliente
 * 
 * Obtiene SOLO los cr√©ditos con saldo pendiente > 0
 * Incluye toda la informaci√≥n necesaria para la p√°gina de abonos
 * 
 * @param {number} clienteId - ID del cliente
 * @returns {Promise<Array>} Array de cr√©ditos pendientes
 */
export async function listarCreditosPendientes(clienteId) {
  try {
    const { data } = await api.get(`/creditos/cliente/${clienteId}/pendientes`);
    console.log('‚úÖ Cr√©ditos pendientes obtenidos:', data.length);
    return data;
  } catch (error) {
    console.error('‚ùå Error obteniendo cr√©ditos pendientes:', error);
    throw error;
  }
}

--------------------------------------------------------------------------------
3.2. Uso en Componente React
--------------------------------------------------------------------------------
UBICACI√ìN: Componente donde necesitas los cr√©ditos (ej: AbonoPage.jsx)

COPIAR Y PEGAR:

import { listarCreditosPendientes } from '../services/CreditosService';

// Dentro de tu componente:

const [creditosPendientes, setCreditosPendientes] = useState([]);
const [loading, setLoading] = useState(false);

// Cargar cr√©ditos pendientes cuando se selecciona un cliente
const cargarCreditosPendientes = async (clienteId) => {
  try {
    setLoading(true);
    
    // Llamar al endpoint especializado
    const creditos = await listarCreditosPendientes(clienteId);
    
    console.log('üìä Cr√©ditos con saldo pendiente:', creditos.length);
    
    // Actualizar estado
    setCreditosPendientes(creditos);
    
    // Mostrar informaci√≥n √∫til
    creditos.forEach(credito => {
      console.log(`Orden ${credito.ordenNumero}: Saldo $${credito.saldoPendiente.toLocaleString()}`);
      console.log(`  - Retenci√≥n: ${credito.tieneRetencionFuente ? 'S√ç' : 'NO'}`);
      console.log(`  - Subtotal: $${credito.subtotal?.toLocaleString()}`);
    });
    
  } catch (error) {
    console.error('‚ùå Error:', error);
    toast.error('Error al cargar cr√©ditos pendientes');
    setCreditosPendientes([]);
  } finally {
    setLoading(false);
  }
};

// Uso en useEffect cuando cambia el cliente seleccionado
useEffect(() => {
  if (clienteSeleccionado?.id) {
    cargarCreditosPendientes(clienteSeleccionado.id);
  }
}, [clienteSeleccionado]);

// Renderizar en la tabla
{creditosPendientes.map(credito => (
  <tr key={credito.creditoId}>
    <td>{credito.ordenNumero}</td>
    <td>{credito.ordenFecha}</td>
    <td>${credito.total?.toLocaleString()}</td>
    <td>${credito.saldoPendiente?.toLocaleString()}</td>
    <td>
      {credito.tieneRetencionFuente && (
        <Badge variant="warning">
          Retenci√≥n: ${credito.retencionFuente?.toLocaleString()}
        </Badge>
      )}
    </td>
    <td>
      <Button onClick={() => registrarAbono(credito)}>
        Abonar
      </Button>
    </td>
  </tr>
))}

================================================================================
4. EJEMPLOS DE USO
================================================================================

--------------------------------------------------------------------------------
EJEMPLO 1: Cliente con 2 cr√©ditos pendientes
--------------------------------------------------------------------------------

REQUEST:
GET /api/creditos/cliente/7/pendientes

RESPONSE 200 OK:
[
  {
    "creditoId": 31,
    "totalCredito": 500000.00,
    "totalAbonado": 200000.00,
    "saldoPendiente": 254306.72,  // 500000 - 200000 - 45693.28 (retenci√≥n)
    "estado": "ABIERTO",
    "ordenId": 124,
    "ordenNumero": 1001,
    "ordenFecha": "2025-12-01",
    "ordenObra": "Casa Matriz",
    "total": 500000.00,
    "subtotal": 420168.07,
    "iva": 79831.93,
    "descuentos": 0.00,
    "tieneRetencionFuente": true,
    "retencionFuente": 45693.28,
    "fechaUltimoAbono": "2025-12-15",
    "cantidadAbonos": 3,
    "sede": {
      "id": 1,
      "nombre": "Insula"
    },
    "cliente": {
      "id": 7,
      "nombre": "Juan P√©rez",
      "nit": "123456789"
    }
  },
  {
    "creditoId": 45,
    "totalCredito": 300000.00,
    "totalAbonado": 100000.00,
    "saldoPendiente": 200000.00,
    "estado": "ABIERTO",
    "ordenId": 156,
    "ordenNumero": 1025,
    "ordenFecha": "2025-12-10",
    "ordenObra": "Proyecto Norte",
    "total": 300000.00,
    "subtotal": 252100.84,
    "iva": 47899.16,
    "descuentos": 0.00,
    "tieneRetencionFuente": false,
    "retencionFuente": 0.00,
    "fechaUltimoAbono": "2025-12-12",
    "cantidadAbonos": 1,
    "sede": {
      "id": 2,
      "nombre": "Sucursal Norte"
    },
    "cliente": {
      "id": 7,
      "nombre": "Juan P√©rez",
      "nit": "123456789"
    }
  }
]

--------------------------------------------------------------------------------
EJEMPLO 2: Cliente sin cr√©ditos pendientes
--------------------------------------------------------------------------------

REQUEST:
GET /api/creditos/cliente/15/pendientes

RESPONSE 200 OK:
[]

NOTA: Array vac√≠o porque todos los cr√©ditos est√°n cerrados o con saldo = 0

--------------------------------------------------------------------------------
EJEMPLO 3: Error - Cliente no existe (manejado por validaciones)
--------------------------------------------------------------------------------

REQUEST:
GET /api/creditos/cliente/999/pendientes

RESPONSE 200 OK:
[]

NOTA: No es error, simplemente no tiene cr√©ditos pendientes

================================================================================
5. COMPARACI√ìN: ANTES VS AHORA
================================================================================

--------------------------------------------------------------------------------
ANTES ‚ùå (GET /api/ordenes/credito?clienteId=7)
--------------------------------------------------------------------------------

PROBLEMAS:
‚ùå Tra√≠a TODAS las √≥rdenes a cr√©dito (13+)
‚ùå No filtraba por saldo > 0 (tra√≠a √≥rdenes ya pagadas)
‚ùå NO inclu√≠a tieneRetencionFuente
‚ùå NO inclu√≠a subtotal (necesario para calcular retenci√≥n)
‚ùå Frontend ten√≠a que filtrar manualmente
‚ùå M√°s datos transferidos
‚ùå M√°s procesamiento en frontend

DATOS QUE FALTABAN:
- tieneRetencionFuente (CR√çTICO)
- subtotal (necesario para retenci√≥n)
- fechaUltimoAbono
- cantidadAbonos

--------------------------------------------------------------------------------
AHORA ‚úÖ (GET /api/creditos/cliente/7/pendientes)
--------------------------------------------------------------------------------

VENTAJAS:
‚úÖ Solo trae cr√©ditos con saldo > 0 (filtro en backend)
‚úÖ Incluye tieneRetencionFuente (CR√çTICO)
‚úÖ Incluye subtotal (para calcular retenci√≥n)
‚úÖ Incluye fechaUltimoAbono y cantidadAbonos
‚úÖ Backend filtra (m√°s eficiente)
‚úÖ Menos datos transferidos
‚úÖ Menos procesamiento en frontend
‚úÖ Ordenado por fecha (m√°s recientes primero)

TODOS LOS DATOS NECESARIOS:
‚úÖ creditoId, saldoPendiente, estado
‚úÖ ordenId, ordenNumero, ordenFecha, ordenObra
‚úÖ total, subtotal, iva, descuentos
‚úÖ tieneRetencionFuente, retencionFuente
‚úÖ sede, cliente
‚úÖ fechaUltimoAbono, cantidadAbonos

================================================================================
6. CASOS DE USO EN LA P√ÅGINA DE ABONOS
================================================================================

--------------------------------------------------------------------------------
CASO 1: Mostrar lista de cr√©ditos pendientes
--------------------------------------------------------------------------------

const creditosPendientes = await listarCreditosPendientes(clienteId);

// Renderizar tabla
creditosPendientes.map(credito => (
  <tr key={credito.creditoId}>
    <td>ORD-{credito.ordenNumero}</td>
    <td>${credito.saldoPendiente.toLocaleString()}</td>
    <td>
      {credito.tieneRetencionFuente && (
        <Badge>Retenci√≥n: ${credito.retencionFuente.toLocaleString()}</Badge>
      )}
    </td>
  </tr>
))

--------------------------------------------------------------------------------
CASO 2: Calcular si aplicar retenci√≥n de fuente
--------------------------------------------------------------------------------

// El endpoint ya incluye tieneRetencionFuente
const aplicarRetencion = credito.tieneRetencionFuente;

// Tambi√©n incluye subtotal para validaciones
const subtotal = credito.subtotal;
const umbralRetencion = 800000;

if (subtotal >= umbralRetencion) {
  // Puede aplicar retenci√≥n
}

--------------------------------------------------------------------------------
CASO 3: Mostrar informaci√≥n adicional
--------------------------------------------------------------------------------

// √öltimo abono
{credito.fechaUltimoAbono && (
  <small>
    √öltimo abono: {formatearFecha(credito.fechaUltimoAbono)}
  </small>
)}

// Cantidad de abonos
<Badge>{credito.cantidadAbonos} abonos realizados</Badge>

// Sede
<span>Sede: {credito.sede.nombre}</span>

--------------------------------------------------------------------------------
CASO 4: Registrar nuevo abono
--------------------------------------------------------------------------------

const registrarAbono = async (credito) => {
  // Validar que tenga saldo pendiente
  if (credito.saldoPendiente <= 0) {
    toast.error('Este cr√©dito no tiene saldo pendiente');
    return;
  }
  
  // Calcular retenci√≥n si aplica
  const retencion = credito.tieneRetencionFuente 
    ? credito.retencionFuente 
    : 0;
  
  // Mostrar modal con informaci√≥n
  abrirModalAbono({
    creditoId: credito.creditoId,
    ordenNumero: credito.ordenNumero,
    saldoPendiente: credito.saldoPendiente,
    retencionFuente: retencion
  });
};

================================================================================
7. CHECKLIST DE IMPLEMENTACI√ìN
================================================================================

BACKEND:
[‚úÖ] Crear archivo CreditoPendienteDTO.java
[‚úÖ] Agregar m√©todo en CreditoRepository.java
[‚úÖ] Agregar m√©todo listarCreditosPendientes en CreditoService.java
[‚úÖ] Agregar endpoint GET en CreditoController.java
[ ] Compilar proyecto (mvn clean install)
[ ] Reiniciar servidor Spring Boot
[ ] Probar con Postman/Insomnia

FRONTEND:
[ ] Agregar funci√≥n listarCreditosPendientes en CreditosService.js
[ ] Actualizar componente de abonos para usar el nuevo endpoint
[ ] Eliminar filtrado manual en frontend (ya filtra el backend)
[ ] Probar en interfaz de usuario
[ ] Verificar que muestre tieneRetencionFuente correctamente

TESTING:
[ ] Probar con cliente con cr√©ditos pendientes
[ ] Probar con cliente sin cr√©ditos pendientes
[ ] Probar con cliente que tiene cr√©ditos cerrados (no deben aparecer)
[ ] Verificar ordenamiento por fecha
[ ] Verificar datos de retenci√≥n de fuente
[ ] Verificar subtotal incluido

================================================================================
FIN DE LA DOCUMENTACI√ìN
================================================================================

‚úÖ C√≥digo backend completamente implementado
‚úÖ DTO creado con todos los campos necesarios
‚úÖ Filtrado autom√°tico en backend (saldo > 0, estado ABIERTO)
‚úÖ Incluye tieneRetencionFuente y subtotal (CR√çTICO)
‚úÖ Listo para copiar y pegar en frontend

¬°Listo para compartir con tus compa√±eros! üöÄ
